# JSCORP HR 시스템 배포 가이드

현재 구현된 백엔드(FastAPI)와 프론트엔드(React)를 배포하는 방법입니다.

---

## 1. 배포 전 확인

- **프론트엔드 빌드**: `frontend` 폴더에서 `npm run build` 실행 시 `frontend/dist`에 정적 파일이 생성됩니다.
- **백엔드**: Python 3.11+, `backend/requirements.txt` 설치 후 `uvicorn app.main:app`으로 실행합니다.

---

## 2. Render.com 배포 (권장)

이 프로젝트에는 `render.yaml`이 포함되어 있어 Render에서 서비스 두 개(백엔드·프론트)를 한 번에 배포할 수 있습니다.

### 2.1 사전 준비

- [Render](https://render.com) 계정
- 이 저장소를 GitHub/GitLab에 연결했거나, Render가 접근 가능한 저장소

### 2.2 배포 절차

1. Render 대시보드에서 **New** → **Blueprint** 선택.
2. 저장소 연결 후 **render.yaml**이 있는 저장소를 선택합니다.
3. Render가 `render.yaml`을 읽어 다음 두 서비스를 생성합니다.
   - **jscorp-hr-backend** (Python Web): `backend`에서 의존성 설치 후 `uvicorn app.main:app --host 0.0.0.0 --port 10000` 실행.
   - **jscorp-hr-frontend** (Static Site): `frontend`에서 `npm install` 및 `npm run build` 후 `frontend/dist` 배포. 백엔드 URL은 `VITE_API_HOST`로 자동 연결됩니다.
4. 배포가 끝나면 백엔드 URL(예: `https://jscorp-hr-backend.onrender.com`)과 프론트엔드 URL(예: `https://jscorp-hr-frontend.onrender.com`)이 부여됩니다.
5. 프론트엔드에서 백엔드에 접속이 안 되면, 로그인 화면의 **API 주소 설정**에 백엔드 URL을 직접 입력해 사용할 수 있습니다.

### 2.3 참고

- Render 무료 플랜은 약 15분 비활성 후 슬립됩니다. 첫 접속 시 지연될 수 있습니다.
- 백엔드 DB는 Render 디스크를 사용하며, 서비스 재시작 시 SQLite DB가 초기화될 수 있습니다. 상시 운영 시 외부 DB(PostgreSQL 등) 연동을 권장합니다.

---

## 3. Docker 배포

### 3.1 백엔드

```bash
cd backend
docker build -t jscorp-hr-backend .
docker run -p 8000:8000 jscorp-hr-backend
```

- 백엔드 Dockerfile은 `backend` 디렉터리 기준이며, `app` 폴더와 `requirements.txt`가 있어야 합니다.
- 포트는 `PORT` 환경변수(기본 8000)를 사용합니다.

### 3.2 프론트엔드

```bash
cd frontend
docker build -t jscorp-hr-frontend .
docker run -p 80:80 jscorp-hr-frontend
```

- 빌드 시점에 백엔드 URL을 쓰려면 `docker build` 시 `--build-arg VITE_API_BASE_URL=https://your-backend-url` 등을 전달하고, Dockerfile에서 `ARG VITE_API_BASE_URL` 후 `ENV`로 빌드에 노출해야 합니다.
- 배포 후 백엔드 URL이 바뀌면 로그인 화면의 API 주소 설정으로 변경할 수 있습니다.

---

## 4. 로컬 프로덕션 실행

### 4.1 백엔드

```bash
cd backend
pip install -r requirements.txt
uvicorn app.main:app --host 0.0.0.0 --port 8000
```

### 4.2 프론트엔드(빌드 결과 서빙)

```bash
cd frontend
npm install
npm run build
npx serve dist
```

- 브라우저에서 `http://localhost:3000`(또는 serve가 안내하는 주소)로 접속합니다.
- **API 주소 설정**에 `http://localhost:8000`을 넣으면 로컬 백엔드와 연동됩니다.

---

## 5. 구현·배포 상태 요약

| 항목 | 내용 |
|------|------|
| 백엔드 | FastAPI, SQLite, JWT 인증, 역할별 API |
| 프론트엔드 | React + Vite, TypeScript, 빌드 산출물: `frontend/dist` |
| Render | `render.yaml`로 백엔드(Web)·프론트(Static) 동시 배포 |
| Docker | `backend/Dockerfile`, `frontend/Dockerfile` 제공 |

배포 후에는 `docs/사용자_도움말.md`를 참고해 사용자에게 로그인 주소와 API 주소 설정 방법을 안내하면 됩니다.
